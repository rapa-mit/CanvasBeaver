================================================================================
Canvas Beaver - Quick Start Guide
================================================================================
Building Better Grade Reports

WHAT IT DOES:
-------------
Computes grades based ONLY on assignments that have been graded (at least one
student has a non-zero score). Excludes ungraded/unassigned work and normalizes
weights proportionally.

BASIC USAGE:
------------
1. Get your Canvas API token:
   a. Log in to Canvas (e.g., https://canvas.mit.edu)
   b. Go to Account → Settings
   c. Scroll to "Approved Integrations"
   d. Click "+ New Access Token"
   e. Give it a name (e.g., "Grade Processing")
   f. Click "Generate Token"
   g. Copy the token immediately (shown only once!)

2. Set Canvas token:
   export CANVAS_TOKEN="your_canvas_api_token"

3. Run grade processor (REQUIRED: must specify --config):
   python3 process_grades.py --config grade_config_canvas.yaml

4. Check output:
   - Console shows which assignments are included
   - individual-grades/*.txt contains per-student reports
   - grades_summary.csv has the summary table
   - anomaly_report.txt lists students with grade pattern alerts

COMMAND-LINE OPTIONS (process_grades.py):
-----------------------------------------
--config FILE           Configuration YAML file (REQUIRED)
                        Recommended: grade_config_canvas.yaml
--course-id ID          Canvas course ID (will prompt if not given)
--include-ungraded      Include ALL assignments, even ungraded (treats as 0%)
                        Default: only count graded assignments
--include-inactive      Include inactive student enrollments
--output-dir DIR        Output directory (default: current directory)
--no-cache              Skip cache, download fresh from Canvas

EXAMPLES:
---------
# Partial semester grading (recommended - only graded work):
python3 process_grades.py --config grade_config_canvas.yaml

# End of semester (include everything, even ungraded):
python3 process_grades.py --config grade_config_canvas.yaml --include-ungraded

# Specify course and output directory:
python3 process_grades.py --config grade_config_canvas.yaml --course-id 33045 --output-dir ./reports

# Force fresh download (skip cache):
python3 process_grades.py --config grade_config_canvas.yaml --no-cache

# Include inactive students:
python3 process_grades.py --config grade_config_canvas.yaml --include-inactive

OUTPUT FILES:
-------------
- individual-grades/*.txt   - Text reports for each student
- individual-grades/*.xlsx  - Excel files with formulas for each student
- grades_summary.csv        - Summary table of all students
- anomaly_report.txt        - Students with unusual grade patterns

EMAIL GRADES TO STUDENTS:
-------------------------
After processing grades, email them to students:

1. Test email configuration:
   ./email_grades.py --test-config

2. Preview what will be sent (dry run):
   ./email_grades.py --dry-run

3. Send to yourself first:
   ./email_grades.py --test-email your@email.com

4. Send to all students:
   ./email_grades.py

EMAIL OPTIONS:
--------------
--test-config           Test SMTP configuration with a test email
--dry-run               Show what would be sent without actually sending
--test-email EMAIL      Send all emails to this address instead of students
--course-id ID          Canvas course ID (will prompt if not given)
--reports-dir DIR       Directory with grade reports (default: individual-grades)
--subject SUBJECT       Email subject line
--smtp-server SERVER    SMTP server (default: from config or env)
--smtp-port PORT        SMTP port (default: 465)
--smtp-user USER        SMTP username (default: from config or env)
--no-tls                Disable TLS encryption
--no-cache              Download fresh data from Canvas

The script will:
- Retrieve student emails from Canvas API
- Attach Excel files with interactive grade formulas
- Inline text reports in email body
- Securely cache SMTP password (asks once, remembers)
- Prompt for confirmation before sending

WHAT TO EXPECT:
---------------
Console output will show:
  "Partial semester grading: 18 of 28 assignments have been graded"
  
  For each assignment type:
  "  Problem Sets: 9/13 graded, weight: 15.0% → 10.4%"
  
  Then normalization:
  "Total partial weight: 51.3% (will normalize to 100%)"

Individual reports will have:
  "GRADE REPORT (PARTIAL SEMESTER - Based on graded assignments only)"
  "CURRENT GRADE: 85.50% = B"
  "(Based on work assigned and graded to date)"

TROUBLESHOOTING:
----------------
Q: "Canvas access token required" error?
A: Get a token from Canvas (Account → Settings → New Access Token)
   Then set: export CANVAS_TOKEN="your_token"

Q: All students still showing low grades?
A: Check if assignments actually have non-zero scores in Canvas

Q: Want old behavior?
A: Use --include-ungraded flag

Q: How do I know what's included?
A: Check console output - it lists all graded assignments by type

FOR MORE INFO:
--------------
- PARTIAL_GRADING_GUIDE.md  : Comprehensive guide with examples
- REFACTORING_SUMMARY.md    : Technical details of changes
- test_partial_grading.py   : Demo script showing the difference

================================================================================
